time O(g) on number of groups
space O(g) on number of groups
