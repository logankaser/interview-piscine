time O(g^2) on number of groups
space O(g) on number of groups
